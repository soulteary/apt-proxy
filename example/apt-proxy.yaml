# APT Proxy Configuration Example
# Copy this file to one of the following locations:
#   - ./apt-proxy.yaml (current directory)
#   - /etc/apt-proxy/apt-proxy.yaml (system-wide)
#   - ~/.config/apt-proxy/apt-proxy.yaml (user config)
#   - ~/.apt-proxy.yaml (user config)
#
# Or specify a custom path with: apt-proxy --config=/path/to/config.yaml
# Environment variable: APT_PROXY_CONFIG_FILE=/path/to/config.yaml
#
# Configuration priority: CLI flags > Environment variables > Config file > Defaults

# Server configuration
server:
  # Network interface to bind to
  host: 0.0.0.0
  
  # Port to listen on
  port: 3142
  
  # Enable verbose debug logging
  debug: false

# Cache configuration
cache:
  # Directory to store cached packages
  dir: /var/cache/apt-proxy
  
  # Maximum cache size in GB (0 to disable size limit).
  # When exceeded, least-recently-used files are evicted automatically to keep total size within the limit.
  max_size_gb: 20
  
  # Cache TTL in hours (0 to disable TTL-based eviction)
  # Default: 168 (7 days)
  ttl_hours: 168
  
  # Cache cleanup interval in minutes (0 to disable automatic cleanup)
  # Default: 60 (1 hour)
  cleanup_interval_min: 60

# Optional: path to distributions/mirrors YAML (distributions.yaml)
# Enables adding or editing distributions and mirrors without recompiling.
# Hot-reload with SIGHUP or POST /api/mirrors/refresh
# distributions_config: ./config/distributions.yaml

# Mirror configuration
# Use full URLs or shortcuts (e.g., cn:tsinghua, cn:ustc, cn:aliyun)
mirrors:
  # Ubuntu mirror
  ubuntu: cn:tsinghua
  
  # Ubuntu Ports mirror (for ARM, etc.)
  ubuntu_ports: ""
  
  # Debian mirror
  debian: cn:ustc
  
  # CentOS mirror
  centos: ""
  
  # Alpine mirror
  alpine: ""

# TLS/HTTPS configuration
tls:
  # Enable TLS
  enabled: false
  
  # Path to TLS certificate file
  cert_file: /etc/ssl/certs/apt-proxy.crt
  
  # Path to TLS private key file
  key_file: /etc/ssl/private/apt-proxy.key

# Security configuration
security:
  # API key for protected management endpoints
  # Supports environment variable expansion: ${APT_PROXY_API_KEY}
  api_key: ${APT_PROXY_API_KEY}
  
  # Enable API authentication (automatically enabled when api_key is set)
  enable_api_auth: true

# Distribution mode
# Options: all, ubuntu, ubuntu-ports, debian, centos, alpine
mode: all
